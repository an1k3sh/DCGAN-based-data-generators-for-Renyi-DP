
# Studying GAN-based Data Generators for Rényi DP

This is the code-base for the implementation of the paper "Pricing GAN-based data generators under Rényi differential privacy" by Jiang et. al.

## Requirements

The following dependencies are required to use these converters:
- Python 3.x
- Pandas
- Numpy
- Matplotlib
- Pytorch (Torch, Torchvision)

## Files

1. `model.py` - Contains the implementation of the GAN model. Has declaration for the classes Generator and Discriminator, denoting the two respective parts of the model
2. `train.py` - Used for training the noised GAN model. The default metadata is as follows

Parameter/Metric         | Value/Type
------------------------ | -------------
Dataset                  | MNIST
Learning Rate            | 2e-4
Input noise dimension    | 100
Noise standard deviation | 0.0
Epochs                   | 25
Batch size               | 128

3. `generate.py` - For generating image samples from the trained noised GAN models

4. `generate_original.py` - For selecting and saving random images sampled from the original MNIST dataset. The generated images are used to compare the quality of images generated by the trained model

5. `finetune_resnet.py` - For loading a pre-trained RESNET50 model and fine-tuning it on the MNIST dataset. The fine-tuned model is used for calculating the inception score of the trained models

6. `inception_score_of_generator.py` - For calculating the inception score of the trained GAN model

7. `inception_score_of_dataset.py` - For calculating the inception score of the original dataset. This can serve as a benchmark for the inception scores of the models

## Usage

- Run the `train.py` file after changing the value of the standard deviation of the noise to be added while training. This step will create a trained model
- Change the file path in `generate.py` to the file path of the desired model to be used and run it. This will create a `.png` file of the generated samples
- [OPTIONAL] You can run the `generate_original.py` to select samples from the original dataset and save them in a `.png` file as well
- Run `finetune_resnet.py` to finetune a pre-trained RESNET50 model and save it
- To find the inception score of the model, change the file path in `inception_score_of_generator.py` to the file path of the desired model to be used and run it. You can run the `inception_score_of_dataset.py` file to calculate the inception score of the original dataset as well

<!-- ## Results

1. `trained_models` - This folder contains the generator models trained at various noise levels. The folder is organized in into various subdirectories of the name `adam_Implementation_<STD>` where `<STD>` denotes the standard deviation of the noise at which the model is trained. Each subdirectory contains files with the name `gen_step<VAL>.pth` where `<VAL>` denotes the number of epochs for which the model is trained

2. `resnet_mnist.pth` - This file contains the RESNET50 model which has been finetuned for the MNIST dataset

3. `results` - This folder contains the following subdirectories or files:
    1. `generated_images_original.png` - A few images sampled from the original dataset
    2. `generated_images` - Folder containing images generated by the trained models. The images are named as `Plot<STD>.png` where `<STD>` denotes the standard deviation of the noise at which the model is trained
    3. `inception_scores.csv` - Contains the calculated inception score of the various trained models -->

## Acknowledgements

1. Xikun Jiang, Chaoyue Niu, Chenhao Ying, Fan Wu, Yuan Luo, “Pricing GAN-based data generators under Re ́nyi differential privacy,” Informa- tion Sciences, Volume 602, 2022, Pages 57-74